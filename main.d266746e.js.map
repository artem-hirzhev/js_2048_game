{"version":3,"sources":["scripts/main.js"],"names":["field","gameIsWorking","score","rows","columns","startButton","document","querySelector","restartButton","gameField","gameScore","messageLose","messageWin","messageStart","setGame","innerText","r","c","cell","createElement","id","updateCell","append","generateTwoOrFour","hasZero","found","Math","floor","random","twoOrFour","getElementById","classList","add","num","value","removeZeroes","row","filter","startGame","remove","restartGame","innerHTML","has2048","isGameOver","move","updatedRow","i","length","push","moveLeft","moveRight","reverse","moveUp","moveDown","window","onload","addEventListener","e","code"],"mappings":"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","file":"main.d266746e.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\nlet field;\nlet score = 0;\nconst rows = 4;\nconst columns = 4;\nlet gameIsWorking;\n\nconst startButton = document.querySelector('.start');\nconst restartButton = document.querySelector('.restart');\nconst gameField = document.querySelector('.game-field');\nconst gameScore = document.querySelector('.game-score');\nconst messageLose = document.querySelector('.message-lose');\nconst messageWin = document.querySelector('.message-win');\nconst messageStart = document.querySelector('.message-start');\n\nwindow.onload = function() {\n  setGame();\n  gameIsWorking = false;\n\n  startButton.addEventListener('click', startGame);\n  restartButton.addEventListener('click', restartGame);\n};\n\nfunction setGame() {\n  field = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  score = 0;\n  gameScore.innerText = '0';\n\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns; c++) {\n      const cell = document.createElement('div');\n\n      cell.id = `${r}-${c}`;\n\n      const num = field[r][c];\n\n      updateCell(cell, num);\n      document.querySelector('.game-field').append(cell);\n    }\n  }\n};\n\nfunction generateTwoOrFour() {\n  if (!hasZero()) {\n    return;\n  }\n\n  let found = false;\n\n  while (!found) {\n    const r = Math.floor(Math.random() * rows);\n    const c = Math.floor(Math.random() * columns);\n    const twoOrFour = Math.random() < 0.1 ? 4 : 2;\n\n    if (field[r][c] === 0) {\n      field[r][c] = twoOrFour;\n\n      const cell = document.getElementById(`${r}-${c}`);\n\n      cell.innerText = `${twoOrFour}`;\n      cell.classList.add(`field-cell--${twoOrFour}`);\n      found = true;\n    }\n  }\n};\n\nfunction updateCell(cell, num) {\n  cell.innerText = '';\n  cell.classList.value = 'field-cell';\n\n  if (num > 0) {\n    cell.innerText = num;\n\n    if (num <= 2048) {\n      cell.classList.add(`field-cell--${num}`);\n    }\n  }\n};\n\nfunction removeZeroes(row) {\n  return row.filter(num => num !== 0);\n};\n\nfunction startGame() {\n  gameIsWorking = true;\n\n  startButton.classList.add('hidden');\n  messageStart.classList.add('hidden');\n  messageLose.classList.add('hidden');\n  messageWin.classList.add('hidden');\n  restartButton.classList.remove('hidden');\n\n  generateTwoOrFour();\n  generateTwoOrFour();\n};\n\nfunction restartGame() {\n  gameField.innerHTML = '';\n  setGame();\n  startGame();\n};\n\nfunction hasZero() {\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns; c++) {\n      if (field[r][c] === 0) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\nfunction has2048() {\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < columns; c++) {\n      if (field[r][c] === 2048) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction isGameOver() {\n  if (hasZero()) {\n    return false;\n  }\n\n  for (let r = rows - 1; r > 0; r--) {\n    for (let c = columns - 1; c > 0; c--) {\n      const cell = field[r][c];\n\n      if (cell !== 0\n        && (cell === field[r - 1][c] || cell === field[r][c - 1])) {\n        return false;\n      }\n    }\n  }\n\n  for (let r = 0; r < rows - 1; r++) {\n    for (let c = 0; c < columns - 1; c++) {\n      const cell = field[r][c];\n\n      if (cell !== 0\n        && (cell === field[r + 1][c] || cell === field[r][c + 1])) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction move(row) {\n  let updatedRow = removeZeroes(row);\n\n  for (let i = 0; i < updatedRow.length - 1; i++) {\n    if (updatedRow[i] === updatedRow[i + 1]) {\n      updatedRow[i] *= 2;\n      updatedRow[i + 1] = 0;\n      score += updatedRow[i];\n    }\n  }\n\n  updatedRow = removeZeroes(updatedRow);\n\n  while (updatedRow.length < columns) {\n    updatedRow.push(0);\n  }\n\n  return updatedRow;\n};\n\nfunction moveLeft() {\n  for (let r = 0; r < rows; r++) {\n    let row = field[r];\n\n    row = move(row);\n    field[r] = row;\n\n    for (let c = 0; c < columns; c++) {\n      const cell = document.getElementById(`${r}-${c}`);\n      const num = field[r][c];\n\n      updateCell(cell, num);\n    }\n  }\n};\n\nfunction moveRight() {\n  for (let r = 0; r < rows; r++) {\n    let row = field[r];\n\n    row = move(row.reverse());\n    field[r] = row.reverse();\n\n    for (let c = 0; c < columns; c++) {\n      const cell = document.getElementById(`${r}-${c}`);\n      const num = field[r][c];\n\n      updateCell(cell, num);\n    }\n  }\n};\n\nfunction moveUp() {\n  for (let c = 0; c < columns; c++) {\n    let row = [field[0][c], field[1][c], field[2][c], field[3][c]];\n\n    row = move(row);\n\n    for (let r = 0; r < rows; r++) {\n      field[r][c] = row[r];\n\n      const cell = document.getElementById(`${r}-${c}`);\n      const num = field[r][c];\n\n      updateCell(cell, num);\n    }\n  }\n};\n\nfunction moveDown() {\n  for (let c = 0; c < columns; c++) {\n    let row = [field[0][c], field[1][c], field[2][c], field[3][c]];\n\n    row = move(row.reverse());\n    row.reverse();\n\n    for (let r = 0; r < rows; r++) {\n      field[r][c] = row[r];\n\n      const cell = document.getElementById(`${r}-${c}`);\n      const num = field[r][c];\n\n      updateCell(cell, num);\n    }\n  }\n};\n\ndocument.addEventListener('keyup', (e) => {\n  if (gameIsWorking) {\n    switch (e.code) {\n      case 'ArrowLeft':\n        moveLeft();\n        generateTwoOrFour();\n        break;\n\n      case 'ArrowRight':\n        moveRight();\n        generateTwoOrFour();\n        break;\n\n      case 'ArrowUp':\n        moveUp();\n        generateTwoOrFour();\n        break;\n\n      case 'ArrowDown':\n        moveDown();\n        generateTwoOrFour();\n        break;\n\n      default:\n        return;\n    }\n  }\n\n  if (isGameOver()) {\n    gameIsWorking = false;\n    messageLose.classList.remove('hidden');\n\n    return;\n  }\n\n  if (has2048()) {\n    gameIsWorking = false;\n    messageWin.classList.remove('hidden');\n\n    return;\n  }\n\n  gameScore.innerText = score;\n});\n"]}